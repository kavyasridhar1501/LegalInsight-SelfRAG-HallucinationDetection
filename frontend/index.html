<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LegalInsight - AI-Powered Contract Analysis</title>
    <link rel="stylesheet" href="styles.css">
    <!-- PDF.js library for PDF parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚öñÔ∏è LegalInsight</h1>
            <p class="description">
                LLM-powered contract analysis using Self-RAG and Hallucination detection.
                Upload contracts, ask questions, and receive instant intelligent analysis.
            </p>
        </header>

        <div class="main-content">
            <!-- API Configuration Section -->
            <div class="card config-section">
                <h2>üîë API Configuration</h2>
                <div class="form-group">
                    <label for="api-provider">Choose AI Provider:</label>
                    <select id="api-provider" onchange="updateApiConfig()">
                        <option value="openai">OpenAI (GPT-4)</option>
                        <option value="anthropic">Anthropic (Claude)</option>
                        <option value="gemini">Google Gemini Pro</option>
                        <option value="groq">Groq (Mixtral/Llama)</option>
                        <option value="cohere">Cohere</option>
                        <option value="mistral">Mistral AI</option>
                        <option value="demo">Demo Mode (No API Key Required)</option>
                    </select>
                </div>
                <div class="form-group" id="api-key-section">
                    <label for="api-key">API Key:</label>
                    <input type="password" id="api-key" placeholder="Enter your API key (stored locally only)">
                    <button onclick="saveApiKey()" class="btn btn-secondary">Save Key</button>
                    <span id="api-status"></span>
                    <p class="help-text">
                        Your API key is stored locally in your browser and never sent anywhere except to the AI provider.
                        <br>Get your API key:
                        <a href="https://platform.openai.com/api-keys" target="_blank" id="api-link">OpenAI</a>
                    </p>
                </div>
            </div>

            <!-- Contract Input Section -->
            <div class="card">
                <h2>üìÑ Contract Input</h2>

                <!-- File Upload -->
                <div class="upload-section">
                    <div class="upload-box" id="upload-box">
                        <div class="upload-icon">üìé</div>
                        <p class="upload-text">Drag & Drop PDF here or click to browse</p>
                        <input type="file" id="pdf-upload" accept=".pdf" onchange="handlePDFUpload(event)" style="display: none;">
                        <button onclick="document.getElementById('pdf-upload').click()" class="btn btn-primary">
                            üìÅ Upload PDF Contract
                        </button>
                    </div>
                    <div id="file-info" style="display: none;">
                        <p>üìÑ File: <strong id="file-name"></strong></p>
                        <p>üìä Pages: <strong id="file-pages"></strong></p>
                        <button onclick="clearFile()" class="btn btn-outline btn-sm">Remove File</button>
                    </div>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <!-- Text Input -->
                <div class="form-group">
                    <label for="contract-text">Paste Contract Text:</label>
                    <textarea id="contract-text" rows="10" placeholder="Paste your legal contract text here...

Example: This Agreement is entered into on January 1, 2024, between Company A and Company B..."></textarea>
                </div>

                <div class="form-group">
                    <label for="query-text">What would you like to know? (Optional)</label>
                    <input type="text" id="query-text" placeholder="e.g., What are the payment terms? What are the termination clauses?">
                </div>

                <div class="button-group">
                    <button onclick="analyzeContract()" class="btn btn-primary" id="analyze-btn">
                        üîç Analyze Contract
                    </button>
                    <button onclick="summarizeContract()" class="btn btn-secondary">
                        üìã Quick Summary
                    </button>
                    <button onclick="loadExample()" class="btn btn-outline">
                        üìù Load Example
                    </button>
                    <button onclick="clearAll()" class="btn btn-outline">
                        üóëÔ∏è Clear All
                    </button>
                </div>

                <div id="loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p id="loading-text">Analyzing contract with AI...</p>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results-section" class="card results-section" style="display: none;">
                <h2>üìä Analysis Results</h2>

                <!-- Time Savings Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card highlight">
                        <div class="metric-value" id="time-saved">--</div>
                        <div class="metric-label">Minutes Saved</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="efficiency">--</div>
                        <div class="metric-label">Efficiency Improvement</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="speedup">--</div>
                        <div class="metric-label">Speedup Factor</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="hallucination-risk">--</div>
                        <div class="metric-label">Hallucination Risk</div>
                    </div>
                </div>

                <!-- Answer Section -->
                <div class="answer-section">
                    <h3>üí° Analysis</h3>
                    <div id="answer-content" class="answer-content"></div>
                </div>

                <!-- Hallucination Analysis -->
                <div class="eigenscore-section">
                    <h3>üéØ Hallucination Analysis</h3>
                    <div class="eigenscore-details">
                        <div class="consistency-bar">
                            <div class="consistency-fill" id="consistency-fill"></div>
                        </div>
                        <div class="eigenscore-info">
                            <p><strong>Consistency Score:</strong> <span id="consistency-score">--</span></p>
                            <p><strong>Interpretation:</strong> <span id="consistency-interpretation">--</span></p>
                        </div>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="performance-section">
                    <h3>‚ö° Performance Metrics</h3>
                    <table class="metrics-table">
                        <tr>
                            <td>Manual Analysis Time (Estimated):</td>
                            <td><strong id="manual-time">--</strong></td>
                        </tr>
                        <tr>
                            <td>AI Analysis Time:</td>
                            <td><strong id="ai-time">--</strong></td>
                        </tr>
                        <tr>
                            <td>Contract Length:</td>
                            <td><strong id="contract-length">--</strong></td>
                        </tr>
                        <tr>
                            <td>Estimated Pages:</td>
                            <td><strong id="estimated-pages">--</strong></td>
                        </tr>
                    </table>
                </div>

                <!-- Alternative Responses -->
                <div class="alternatives-section">
                    <h3>üîÑ Alternative Responses (for verification)</h3>
                    <button onclick="toggleAlternatives()" class="btn btn-outline btn-sm">Show/Hide Alternatives</button>
                    <div id="alternatives-content" style="display: none;"></div>
                </div>
            </div>

            <!-- Analytics Dashboard -->
            <div id="analytics-section" class="card" style="display: none;">
                <h2>üìà Session Analytics</h2>
                <div class="analytics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="total-analyses">0</div>
                        <div class="metric-label">Total Analyses</div>
                    </div>
                    <div class="metric-card highlight">
                        <div class="metric-value" id="total-time-saved">0</div>
                        <div class="metric-label">Total Minutes Saved</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="avg-efficiency">0%</div>
                        <div class="metric-label">Avg Efficiency</div>
                    </div>
                </div>
                <button onclick="refreshAnalytics()" class="btn btn-secondary">Refresh Analytics</button>
            </div>
        </div>

    </div>

    <script src="app.js"></script>
</body>
</html>
